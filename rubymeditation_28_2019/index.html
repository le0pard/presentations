<!DOCTYPE html>
<html lang="en">
<head>
    <title>Gettext - i18n for big web project</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="shower/themes/material/styles/styles.css" />
    <style>
        .shower {
            --slide-ratio: calc(16 / 9);
        }
    </style>
</head>
<body class="shower list">

    <header class="caption">
      <h1>Gettext - i18n for big web project</h1>
      <p>Oleksii Vasyliev, Railsware</p>
    </header>

    <section class="slide" id="Cover">
      <h2>Gettext - i18n for big web project</h2>
      <p>Brought to you by <a href="http://leopard.in.ua/">Alexey Vasiliev</a>, <a
          href="http://railsware.com/">Railsware</a></p>
      <!--
          To apply styles to the certain slides
          set slide ID to get needed elements
          -->
      <style>
        #Cover {
          background-color: #04A05F;
        }

        #Cover h2 {
          margin: 50px 0 0;
          color: #FFF;
          text-align: left;
          font-weight: bold;
          font-size: 66px;
          line-height: 130%;
        }

        #Cover p {
          margin: 50px 0 0;
          text-align: left;
          color: #FFF;
          font-style: italic;
          font-size: 20px;
        }

        #Cover p a {
          color: #FFF;
        }
      </style>
    </section>

    <section class="slide" id="AboutMeSlide"><div>
      <h2>Oleksii Vasyliev</h2>
      <ul>
        <li>Web and Mobile Developer, DevOps</li>
        <li>Open-Source libs: <a href="https://github.com/certonid/certonid">Certonid</a>, <a href="https://github.com/le0pard/storybook-addon-root-attribute">Storybook Addon Root Attribute</a>, <a href="http://pgtune.leopard.in.ua/">PGTune</a>, <a href="http://sql-joins.leopard.in.ua/">SQL Joins Visualizer</a>, etc</li>
        <li>Open-Source books: <a href="http://postgresql.leopard.in.ua/">Setting up and scaling of PostgreSQL (Russian)</a>, <a href="http://chef.leopard.in.ua/">Cooking Infrastructure by Chef</a></li>
        <li>Leading <a href="http://www.rwpod.com/">RWpod</a> podcast about Ruby and JavaScript</li>
      </ul>
    </div></section>

    <section class="slide" id="I18nCover">
      <h2 class="shout">I18N and L10N</h2>
    </section>

    <section class="slide" id="I18nProblems">
      <div>
        <h2>Programming problems</h2>
        <div class="columns two">
          <ul>
            <li>Naming things</li>
            <li>Cache invalidation</li>
            <li>Time and Timezones</li>
            <li>Internationalization and Localization</li>
          </ul>
          <img src="pictures/your_problems.png" alt="not happy" />
        </div>
      </div>
      <style>
        #I18nProblems img {
          width: 88%;
        }
      </style>
    </section>

    <section class="slide" id="I18nDescription">
      <div>
        <h2>Internationalization and localization</h2>
        <div class="columns two">
          <p>adapting computer software to different languages, regional peculiarities and technical requirements of a target locale</p>
          <img src="pictures/i18n.png" alt="i18n" />
        </div>
      </div>
      <style>
        #I18nDescription img {
          width: 100%;
        }
      </style>
    </section>

    <section class="slide" id="I18nHell">
      <div>
        <img src="pictures/welcome_to_hell.png" alt="welcome to hell" class="cover" />
      </div>
    </section>

    <section class="slide" id="I18nWhySoHard">
      <div>
        <h2>Why i18n and l10n So Dang Hard?</h2>
        <ul>
          <li>Thousands of languages in the world</li>
          <li>Not all languages take up the same amount of space</li>
          <li>Some languages read from right to left or vertically</li>
          <li>There's the cultural issue</li>
          <li>Not everyone is a translator or programmer</li>
        </ul>
      </div>
    </section>

    <section class="slide" id="I18nProject">
      <div>
        <h2>Our Project - codename "Didi"</h2>
        <ul>
          <li>Rails 3.2.22</li>
          <li>JQuery + RJS "framework"</li>
          <li>Smt_rails - shared mustache templates</li>
          <li>React 16.1.1</li>
          <li>React-native 0.47.2</li>
          <li>Need to translate everywhere</li>
          <li>Translation will be done by people without a technical background</li>
          <li>No money for refactoring :(</li>
        </ul>
      </div>
    </section>

    <section class="slide" id="I18nRailsSolution">
      <div>
        <h2>Rails i18n API</h2>
        <pre><code>en:
  errors:
    format: "%{attribute} %{message}"
    messages:
      model_invalid: "Validation failed: %{errors}"</code></pre>
      </div>
    </section>

    <section class="slide" id="I18nRailsSolutionIssue">
      <div>
        <h2>Rails i18n API not fit</h2>
        <ul>
          <li>Good for backend translations</li>
          <li>For frontend you need use separate lib, like i18n-js</li>
          <li>It doesn't solve, how to manage translations (how will work translators)</li>
          <li>It doesn't solve, how to manage translations between frontend, backend and mobile</li>
        </ul>
      </div>
    </section>

    <section class="slide" id="I18nExamplesCover">
      <h2 class="shout">one more thing...</h2>
    </section>

    <section class="slide" id="I18nGodOfWarCover">
      <div>
        <img src="pictures/god-of-war-cover.png" alt="God of War" class="cover" />
      </div>
    </section>

    <section class="slide" id="I18nGodOfWarBoy">
      <div>
        <img src="pictures/gow-boy.jpg" alt="God of War" class="cover" />
      </div>
    </section>

    <section class="slide" id="I18nGodOfWarMemes">
      <div>
        <img src="pictures/gow-memes.png" alt="God of War Memes" class="cover" />
      </div>
    </section>

    <section class="slide" id="I18nGodOfWarRussian">
      <div>
        <img src="pictures/gow-rus.png" alt="God of War Russian" class="cover" />
      </div>
    </section>

    <section class="slide" id="I18nContext">
      <h2 class="shout">Context</h2>
    </section>

    <section class="slide" id="I18nContextExample">
      <div>
        <h2>Context example</h2>
        <p>Let's translate "Press":</p>
        <ul>
          <li>Press my shirt</li>
          <li>I work in a press</li>
          <li>Press the button</li>
        </ul>
        <p>Russian example: "Мама мыла раму"</p>
      </div>
    </section>

    <section class="slide" id="I18nContextExample2">
      <div>
        <p><strong>Latin</strong></p>
        <p>Spiritus quidem promptus est, caro autem infirma</p>
        <p><strong>Literal translation</strong></p>
        <p>Alcohol is good, but rotten meat (Russian: "Спирт хорош, а мясо протухло")</p>
        <p><strong>Correct translation</strong></p>
        <p>The spirit is vigorous, but the flesh is weak (Russian: "Дух бодр, плоть же немощна")</p>
      </div>
    </section>

    <section class="slide" id="I18nRailsContextProblem1">
      <div>
        <h2>Rails i18n API - context</h2>
        <pre><code>en:
  about:
    link_text: "Press here"</code></pre>
      </div>
    </section>

    <section class="slide" id="I18nRailsContextProblem1">
      <div>
        <h2>Rails i18n API - context</h2>
        <pre><code>en:
  about_page:
    link_text_for_getting_info_about_privacy_policy_details:
      "Press here"</code></pre>
      </div>
    </section>

    <section class="slide" id="I18nRailsSystems">
      <div>
        <h2>Rails i18n API - web services</h2>
        <ul>
          <li><a href="https://translation.io/rails/pricing">Translation.io - €0.01/key per month</a></li>
          <li><a href="https://www.localeapp.com/pricing/">Localeapp.com - from €24 for 1000 keys per month</a></li>
          <li><a href="https://webtranslateit.com/en/plans">Webtranslateit.com - from €49 for 2000 keys per month</a></li>
          <li><a href="https://phrase.com/pricing/">Webtranslateit.com - from $140 per month</a></li>
          <li>etc...</li>
        </ul>
      </div>
    </section>

    <section class="slide" id="I18nRailsServicesInsane">
      <div>
        <video class="cover" autoplay loop muted>
          <source src="pictures/insane.mp4" type='video/mp4;codecs="avc1.42E01E, mp4a.40.2"' />
        </video>
      </div>
      <style>
        #I18nRailsServicesInsane video {
          width: 100%;
        }
      </style>
    </section>

    <section class="slide" id="I18nMeetGettext">
      <div>
        <h2>Meet GetText</h2>
        <ul>
          <li>Initial release - 1990</li>
          <li>Separates programming from translating</li>
          <li>Produce a <strong>.pot</strong> (Portable Object Template) file, which contains a list of all the translatable
            strings extracted from the sources</li>
          <li>Translator derives a <strong>.po</strong> (Portable Object) file from the template</li>
          <li><strong>.po</strong> files can be compiled into binary <strong>.mo</strong> (Machine Object) files or into JSON
          </li>
        </ul>
      </div>
    </section>

    <section class="slide" id="I18nGettextUtils">
      <div>
        <h2>GetText libraries</h2>
        <div class="columns two">
          <img src="pictures/gettext.svg" alt="gettext" />
          <ul>
            <li>Rails - <a href="https://github.com/grosser/gettext_i18n_rails">gettext_i18n_rails</a>, <a href="https://github.com/grosser/fast_gettext">FastGettext</a></li>
            <li>React/JS - <a href="https://github.com/laget-se/react-gettext-parser">react-gettext-parser</a>, <a href="https://github.com/mikeedwards/po2json">po2json</a>, <a href="https://github.com/perchlabs/po-loader">po-loader</a>, <a href="https://github.com/messageformat/Jed">jed</a></li>
            <li>React-Native - <a href="https://github.com/laget-se/react-gettext-parser">react-gettext-parser</a>, <a href="https://github.com/mikeedwards/po2json">po2json</a>, <a href="https://github.com/messageformat/Jed">jed</a>, <a href="https://github.com/DylanVann/react-native-locale-detector">react-native-locale-detector</a></li>
          </ul>
        </div>
      </div>
      <style>
        #I18nGettextUtils img {
          width: 90%;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextTasks1">
      <div>
        <pre><code>#!/bin/bash

echo -n 'Extracting strings from Rails app...'
bundle exec rake gettext:find > /dev/null 2>&1
echo ' Done!'

echo -n 'Adding missing SPA locale entrypoint files...'
yarn gulp locale:spa > /dev/null 2>&1
echo ' Done!'

echo -n 'Extracting strings from SPA...'
yarn gulp build:pot > /dev/null 2>&1
make spa > /dev/null 2>&1
echo ' Done!'
</code></pre>
      </div>
      <style>
        #I18nGettextTasks1 code {
          font-size: 1rem;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextTasks2">
      <div>
        <pre><code>namespace :gettext do
  def files_to_translate
    Dir.glob("{app,lib,config,locale}/**/*.{rb,erb,haml,rabl}")
  end
end</code></pre>
      </div>
    </section>

    <section class="slide" id="I18nGettextTasks3">
      <div>
        <pre><code>gulp.task('build:pot', function() {
  return gulp.src('webpack/**/*.js*')
    .pipe(reactGettextParser({
      output: 'spa.pot',
      funcArgumentsMap: {
        __: ['msgid'],
        n__: ['msgid', 'msgid_plural'],
        p__: ['msgctxt', 'msgid'],
        np__: ['msgctxt', 'msgid', 'msgid_plural']
      }
    }))
    .pipe(gulp.dest('locale'));
});</code></pre>
      </div>
      <style>
        #I18nGettextTasks3 code {
          font-size: 1.2rem;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextTasks4">
      <div>
        <pre><code>// webpack
externals: {
__i18n: 'i18n'
}

// gulp
const template = _template(`
import Jed from 'jed';
import messages from '../../locale/<%= lang %>/spa.po';
const i18n = new Jed(messages);
window.i18n = i18n;
`.trim().concat('\n')
);</code></pre>
      </div>
      <style>
        #I18nGettextTasks4 code {
          font-size: 1.2rem;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextJsTranslations">
      <div>
        <pre><code>// code
import i18n from '__i18n';

export const __ = function() {
  return i18n.gettext.apply(i18n, arguments);
};
export const n__ = function() {
  return i18n.ngettext.apply(i18n, arguments);
};
export const p__ = function() {
  return i18n.pgettext.apply(i18n, arguments);
};
export const np__ = function() {
  return i18n.npgettext.apply(i18n, arguments);
};
</code></pre>
      </div>
      <style>
        #I18nGettextJsTranslations code {
          font-size: 1rem;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextTasks5">
      <div>
        <pre><code>import locale from 'react-native-locale-detector';
import {en, fr, ru} from 'locale';

let messages;

if (/^ru/.test(locale)) {
  messages = ru;
} else if (/^fr/.test(locale)) {
  messages = fr;
} else {
  messages = en;
}</code></pre>
      </div>
      <style>
        #I18nGettextTasks5 code {
          font-size: 1.2rem;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextTranslations">
      <div>
        <pre><code>_('N/A')

N_('Car', '%{n} Cars', 2) % { n: count } == '2 Autos'
slug = obj.new_record? ? _('Create %{resource}') : _('Update %{resource}')
slug % {resource: resource_name}

P_('Context', 'not-found') == 'not-found'
S_('Context|not-found') == 'not-found'

PN_('Fruit', 'Apple', 'Apples', 3) == 'Äpfel'
PN_('Fruit', 'Apple', 'Apples', 1) == 'Apfel'
        </code></pre>
      </div>
      <style>
        #I18nGettextTranslations code {
          font-size: 1.2rem;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextHTMLTranslations1">
      <div>
        <pre><code>%html{lang: FastGettext.locale}

day.localize(FastGettext.locale).to_additional_s('Ed')

def date_long_label(date)
  date.to_date.localize(FastGettext.locale).to_additional_s('MMMMd')
end

def date_short_label(date)
  date.to_date.localize(FastGettext.locale).to_additional_s('MMMd')
end
        </code></pre>
      </div>
      <style>
        #I18nGettextHTMLTranslations1 code {
          font-size: 1.2rem;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextJsTranslations2">
      <div>
        <pre><code>// react
&lt;ActionButton
  label={__('Deselect')}
  onClick={onDeselectClick} /&gt;

{
  isLoading &amp;&amp;
  &lt;Loader
    text={__('Please wait data are loading&hellip;')}/&gt;
}
    </code></pre>
      </div>
    </section>

    <section class="slide" id="I18nGettextJsTranslations3">
      <div>
        <pre><code>i18n.translate("There is one translation.")
  .onDomain("messages")
  .withContext("male")
  .ifPlural(num, "There are %d translations.")
  .fetch(num);

moment.locale(this.getLocale());

moment(date).format(dateFormat.toString());
moment(currentDate).subtract(offset, 'days').format('YYYY-MM-DD')</code></pre>
      </div>
      <style>
        #I18nGettextJsTranslations3 code {
          font-size: 1.3rem;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextJsNoNeedMomentjs">
      <div>
        <h2>You don't (may not) need Moment.js</h2>
        <table class="striped">
          <thead>
            <tr>
              <th>Name</th>
              <th>Size(gzip)</th>
              <th>Tree-shaking</th>
              <th>Pattern</th>
              <th>Timezone Support</th>
              <th>Locale</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><a href="https://momentjs.com/" rel="nofollow">Moment.js</a></td>
              <td>329K(69.6K)</td>
              <td>No</td>
              <td>OO</td>
              <td>Good(moment-timezone)</td>
              <td>123</td>
            </tr>
            <tr>
              <td><a href="https://moment.github.io/luxon/" rel="nofollow">Luxon</a></td>
              <td>59.9K(17.2K)</td>
              <td>No</td>
              <td>OO</td>
              <td>Good(Intl)</td>
              <td>-</td>
            </tr>
            <tr>
              <td><a href="https://date-fns.org" rel="nofollow">date-fns</a></td>
              <td>78.4k(13.4k)</td>
              <td>Yes</td>
              <td>Functional</td>
              <td>Not yet</td>
              <td>50</td>
            </tr>
            <tr>
              <td><a href="https://github.com/iamkun/dayjs">dayjs</a></td>
              <td>6.5k(2.6k) without plugins</td>
              <td>No</td>
              <td>OO</td>
              <td>Not yet</td>
              <td>130</td>
            </tr>
          </tbody>
        </table>
      </div>
      <style>
        #I18nGettextJsNoNeedMomentjs table {
          font-size: 1.2rem;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextPlural">
      <div>
        <img src="pictures/gettext_plural.png" alt="gettext plural" class="cover" />
      </div>
    </section>

    <section class="slide" id="I18nGettextPluralTable">
      <div>
        <img src="pictures/gettext_plural_table.png" alt="gettext plural" class="cover" />
        <figcaption class="copyright right black">
          <a href="http://docs.translatehouse.org/projects/localization-guide/en/latest/l10n/pluralforms.html">Source</a>
        </figcaption>
      </div>
    </section>

    <section class="slide" id="I18nGettextWebInterface">
      <div>
        <h2>Web... it is separate story...</h2>
        <img src="pictures/right-to-left-icons.png" alt="web" class="cover" />
      </div>
      <style>
        #I18nGettextWebInterface img {
          top: 65%;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextDermomed">
      <div>
        <h2>Cultural peculiarities</h2>
        <p>Alcohol consumption is prohibited in Islam</p>
        <img src="pictures/right-to-left-cultural.png" alt="web" class="cultural place b l" />
        <img src="pictures/dermomed.jpg" alt="dermomed" class="dermo place b r" />
      </div>
      <style>
        #I18nGettextDermomed .cultural {
          width: 50%;
          bottom: 40px;
        }

        #I18nGettextDermomed .dermo {
          height: 100%;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextEditors">
      <div>
        <h2>GetText editors</h2>
        <div class="columns two">
          <ul>
            <li><a href="https://weblate.org/en/">Weblate (web)</a></li>
            <li><a href="http://zanata.org/">Zanata (web)</a></li>
            <li><a href="http://pootle.translatehouse.org/index.html">Pootle (web)</a></li>
            <li><a href="https://github.com/GlotPress/GlotPress-WP">GlotPress (web)</a></li>
            <li><a href="https://poedit.net">Poedit (desktop)</a></li>
            <li>ect</li>
          </ul>
          <img src="pictures/poedit_icon.svg" alt="poedit" />
        </div>
      </div>
      <style>
        #I18nGettextEditors img {
          width: 90%;
        }
      </style>
    </section>

    <section class="slide" id="I18nGettextWeblate1">
      <div>
        <img src="pictures/weblate1.png" alt="Weblate" class="cover" />
      </div>
    </section>

    <section class="slide" id="I18nGettextWeblate2">
      <div>
        <img src="pictures/weblate2.png" alt="Weblate" class="cover" />
      </div>
    </section>

    <section class="slide" id="I18nGettextWeblate3">
      <div>
        <img src="pictures/weblate3.png" alt="Weblate" class="cover" />
      </div>
    </section>

    <section class="slide" id="I18nGettextWeblate4">
      <div>
        <img src="pictures/weblate4.png" alt="Weblate" class="cover" />
      </div>
    </section>

    <section class="slide" id="I18nAlternativeIntl">
      <div>
        <h2>What about SPA (translations on frontent) + API backend?</h2>
        <ul>
          <li>
            I prefer <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl">ECMAScript Internationalization API (Intl)</a>:
            <ul>
              <li>Build-in in browsers</li>
              <li>For old browsers you can use polyfill</li>
              <li>"Intl.Collator" - enable language-sensitive string comparison</li>
              <li>"Intl.DateTimeFormat" - enable language-sensitive date and time formatting</li>
              <li>"Intl.PluralRules" - enable plural-sensitive formatting and language-specific rules for plurals</li>
            </ul>
          </li>
        </ul>
      </div>
      <style>
        #I18nAlternativeIntl ul {
          font-size: 1.4rem;
        }
      </style>
    </section>

    <section class="slide" id="I18nSummary1">
      <div>
        <h2>GetText Pros</h2>
        <ul>
          <li>Mature and it seems to be standard de-facto in GNU/Linux world</li>
          <li>Easy to translate. Translators don't have to bother themselves with any development concepts</li>
          <li>Easy to maintain both for developers and for translators</li>
          <li>It's a cross-platform solution (portability)</li>
          <li>Provide ability to add context for translators</li>
          <li>Enough editors (desktop and web) to manage translations</li>
        </ul>
      </div>
    </section>

    <section class="slide" id="I18nSummary2">
      <div>
        <h2>GetText Cons</h2>
        <ul>
          <li>Not very dynamic</li>
          <li>File format specific</li>
          <li>Not very extensible</li>
          <li>This is not a new technology :)</li>
        </ul>
      </div>
    </section>


    <section class="slide" id="QuestionsSlide"><div>
      <h2>&lt;Thank You!&gt; Questions?</h2>
      <div class="contacts">
        <h3>Contact information</h3>
        <ul>
          <li>web: <a href="http://leopard.in.ua/">leopard.in.ua</a></li>
          <li>github: <a href="https://github.com/le0pard">le0pard</a></li>
          <li>twitter: <a href="https://twitter.com/leopard_me">@leopard_me</a></li>
        </ul>
      </div>
      <img src="pictures/questions.png" alt="QuestionsSlide" class="place l b" />
      <style>
        #QuestionsSlide .contacts {
          margin-top: 100px;
          margin-left: 450px;
        }
      </style>
    </div></section>

    <div class="progress"></div>

    <script src="shower/shower.min.js"></script>
    <!-- Copyright © 2019 Yours Truly, Famous Inc. -->

</body>
</html>
