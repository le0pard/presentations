<!DOCTYPE html>
<html lang="en">
<head>
    <title>Chef InSpec for your security and compliance automation</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="shower/themes/material/styles/styles.css" />
    <style>
        .shower {
            --slide-ratio: calc(16 / 9);
        }
    </style>
</head>
<body class="shower list">

    <header class="caption">
      <h1>Chef InSpec for your security and compliance automation</h1>
      <p>Oleksii Vasyliev, Railsware</p>
    </header>

    <section class="slide" id="Cover">
      <h2>Chef InSpec for your security and compliance automation</h2>
      <p>Brought to you by <a href="http://leopard.in.ua/">Alexey Vasiliev</a>, <a
          href="http://railsware.com/">Railsware</a></p>
      <!--
          To apply styles to the certain slides
          set slide ID to get needed elements
          -->
      <style>
        #Cover {
          background-color: #04A05F;
        }

        #Cover h2 {
          margin: 50px 0 0;
          color: #FFF;
          text-align: left;
          font-weight: bold;
          font-size: 66px;
          line-height: 130%;
        }

        #Cover p {
          margin: 50px 0 0;
          text-align: left;
          color: #FFF;
          font-style: italic;
          font-size: 20px;
        }

        #Cover p a {
          color: #FFF;
        }
      </style>
    </section>

    <section class="slide" id="AboutMeSlide"><div>
      <h2>Oleksii Vasyliev</h2>
      <ul>
        <li>Web and Mobile Developer, DevOps</li>
        <li>Open-Source libs: <a href="https://github.com/certonid/certonid">Certonid</a>, <a href="https://github.com/le0pard/storybook-addon-root-attribute">Storybook Addon Root Attribute</a>, <a href="http://pgtune.leopard.in.ua/">PGTune</a>, <a href="http://sql-joins.leopard.in.ua/">SQL Joins Visualizer</a>, etc</li>
        <li>Open-Source books: <a href="http://postgresql.leopard.in.ua/">Setting up and scaling of PostgreSQL (Russian)</a>, <a href="http://chef.leopard.in.ua/">Cooking Infrastructure by Chef</a></li>
        <li>Leading <a href="http://www.rwpod.com/">RWpod</a> podcast about Ruby and JavaScript</li>
      </ul>
    </div></section>

    <section class="slide" id="WebSecurityCover">
      <h2 class="shout">Security</h2>
    </section>

    <section class="slide" id="WebSecurityCompany">
      <div>
        <h2>Company security areas</h2>
        <ul>
          <li><strong>Application security</strong>: the app sec team is responsible for handling everything from project inception to release from a security standpoint</li>
          <li><strong>Incident response and monitoring</strong>: they are in charge of monitoring the production systems and kicking off the response process for any incidents that arise</li>
          <li><strong>Corporate and IT security</strong>: they often manage internal security (employees directory, asset management, devices monitoring, etc.)</li>
          <li><strong>Governance Risk and Compliance (GRC)</strong>: this area is about managing certifications like SOC2, Fedramp, etc</li>
        </ul>
      </div>
      <style>
        #WebSecurityCompany li {
          font-size: 1.4rem;
        }
      </style>
    </section>

    <section class="slide" id="ITSecurityVsCompliance">
      <div>
        <h2>"IT Security" vs "IT Compliance"</h2>
        <p><strong>Information Security</strong> is the practice of exercising due diligence and due care to protect the confidentiality, integrity, and availability of critical business assets</p>
        <p><strong>IT Compliance</strong> is the process of meeting a third party’s requirements for digital security with the aim of enabling
        business operations in a particular market or with a particular customer</p>
      </div>
    </section>

    <section class="slide" id="ITSecurityVsCompliance2">
      <div>
        <h2>"IT Security" vs "IT Compliance"</h2>
        <h3>Security pros</h3>
        <ul>
          <li>Is practiced for its own sake, not to satisfy a third party's needs</li>
          <li>Is driven by the need to protect against constant threats to an organization's assets</li>
          <li>Is never truly finished and should be continuously maintained and improved</li>
        </ul>
      </div>
    </section>

    <section class="slide" id="ITSecurityVsCompliance3">
      <div>
        <h2>"IT Security" vs "IT Compliance"</h2>
        <h3>Compliance pros</h3>
        <ul>
          <li>Is practiced to satisfy external requirements and facilitate business operations</li>
          <li>Is driven by business needs rather than technical needs</li>
          <li>Is "done" when the third party is satisfied</li>
        </ul>
      </div>
    </section>

    <section class="slide" id="ITComplianceBenefits">
      <div>
        <h2>Security Compliance Benefits</h2>
        <ul>
          <li>Increased Customer Trust and Reputation</li>
          <li>Helps You Avoid Fines and Penalties</li>
          <li>Protects Your Business Reputation</li>
          <li>Effective Security Compliance Enhances Company Culture</li>
        </ul>
      </div>
    </section>

    <section class="slide" id="AutomationCover">
      <h2 class="shout">Audit and Compliance Automation</h2>
    </section>

    <section class="slide" id="AuthomationTools">
      <div>
        <h2>Automation tools</h2>
        <div class="columns two">
          <ul>
            <li><a href="https://aws.amazon.com/security-hub/">AWS Security Hub</a></li>
            <li><a href="https://chronicle.security/">Chronicle</a></li>
            <li><a href="http://gauntlt.org/">Gauntlt</a></li>
            <li><a href="https://github.com/opencontrol/compliance-masonry">Compliance Masonry</a></li>
            <li><a href="https://www.inspec.io/">Chef InSpec</a></li>
            <li><a href="https://github.com/aelsabbahy/goss">Goss</a></li>
          </ul>
          <img src="pictures/aws_security_hub.png" alt="aws" />
        </div>

      </div>
      <style>
        #AuthomationTools li {
          font-size: 1.4rem;
        }
        #AuthomationTools img {
          width: 75%;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecCover">
      <h2 class="shout">Chef Inspec</h2>
    </section>

    <section class="slide" id="ChefInspecIntro">
      <div>
        <h2>Chef InSpec</h2>
        <p><a href="https://www.inspec.io/">InSpec</a> is an open-source testing framework by Chef that enables you to specify
        compliance, security, and other policy requirements</p>
        <img src="pictures/inspec.jpg" alt="" class="place b" />
      </div>
      <style>
        #ChefInspecIntro img {
          height: 50%;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecSupport">
      <div>
        <h2>Chef InSpec Support</h2>
        <ul>
          <li>Linux (CentOS, Debian, Ubuntu, OpenSUSE, etc)</li>
          <li>Mac OS</li>
          <li>Windows (PowerShell 5.0 or above is required)</li>
          <li>Docker images</li>
          <li>AWS Platform</li>
          <li>Azure Platform</li>
          <li>Google Cloud Platform</li>
        </ul>
      </div>
      <style>
        #ChefInspecIntro img {
          height: 50%;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecHelp">
      <div>
        <img src="pictures/inspec_help.png" alt="" class="cover" />
      </div>
    </section>

    <section class="slide" id="ChefInspecProfile">
      <div>
        <h2>Inspec Profile structure</h2>
        <div class="columns two">
          <pre><code>$ tree nginx
nginx
├── README.md
├── controls
│ └── example.rb
├── inspec.lock
└── inspec.yml</code></pre>

        </div>
      </div>
    </section>

    <section class="slide" id="ChefInspecYml">
      <div>
        <h2>inspec.yml</h2>
        <div class="columns two">
          <pre><code>name: ssh
title: Basic SSH
maintainer: Alexey Vasiliev
copyright: Alexey Vasiliev
copyright_email: support@never.answer
license: MIT, All rights reserved
summary: Verify that SSH Server and SSH Client are configured securely
version: 1.0.0
supports:
  - os-family: linux
depends:
  - name: profile
    path: ../path/to/profile
inspec_version: "~> 2.1"</code></pre>
        </div>
      </div>
      <style>
        #ChefInspecYml code {
          font-size: 0.8rem;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecRuby">
      <div>
        <h2>controls/example.rb (<a href="https://www.inspec.io/docs/reference/resources/">resources</a>)</h2>
        <div class="columns two">
          <pre><code>describe file('/tmp/test.txt') do
  it { should be_file }
end</code></pre>
        </div>
      </div>
    </section>

    <section class="slide" id="ChefInspecExpect">
      <div>
        <h2>"should" vs "expect" syntax</h2>
        <div class="columns two">
          <pre><code>describe file('/tmp/test.txt') do
  it 'should be a file' do
    expect(subject).to(be_file)
  end
end</code></pre>
        </div>
      </div>
    </section>

    <section class="slide" id="ChefInspecExpect2">
      <div>
        <h2>"should" vs "expect" syntax</h2>
        <div class="columns two">
          <pre><code>describe 'test file' do
  subject { file('/tmp/test.txt') }
  it 'should be a file' do
    expect(subject).to(be_file)
  end
end</code></pre>
        </div>
      </div>
    </section>

    <section class="slide" id="ChefInspecSSH">
      <div>
        <h2>Check SSH Protocol</h2>
        <div class="columns two">
          <pre><code>describe sshd_config do
  its('Protocol') { should eq('2') }
end</code></pre>
          <pre><code>$ inspec exec test.rb
Profile: tests from test.rb (tests from test.rb)
Version: (not specified)
Target:  local://

  SSH Configuration
     ×  Protocol should eq "2"

     expected: "2"
          got: nil

     (compared using ==)

Test Summary: 0 successful, 1 failure, 0 skipped</code></pre>
        </div>
      </div>
      <style>
        #ChefInspecSSH code {
          font-size: 0.9rem;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecLocations">
      <div>
        <h2>Inspec specified locations</h2>
          <pre><code>$ inspec exec /path/to/linux-baseline
$ inspec exec supermarket://username/linux-baseline
$ inspec exec git@github.com:dev-sec/linux-baseline.git
$ inspec exec https://api_token@github.com/dev-sec/linux-baseline.git
$ inspec exec https://webserver/linux-baseline.tar.gz
$ inspec exec https://webserver/linux-baseline.zip
          </code></pre>
      </div>
      <style>
        #ChefInspecLocations code {
          font-size: 1.3rem;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecTarget">
      <div>
        <h2>Inspec target</h2>
        <pre><code>$ inspec exec test.rb
$ inspec exec test.rb -t ssh://user@hostname -i /path/to/key
$ inspec exec test.rb -t winrm://Administrator@windowshost
  --password 'your-password'
$ inspec exec test.rb -t winrm://windowshost --user 'UserName@domain'
  --password 'your-password'
$ inspec exec test.rb -t docker://container_id
$ ...cloud platforms on next slides...
        </code></pre>
      </div>
      <style>
        #ChefInspecTarget code {
          font-size: 1.3rem;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecOrConditions">
      <div>
        <h2>Inspec "OR" check</h2>
        <pre><code>describe.one do
  describe ssh_config do
    its('Protocol') { should eq('3') }
  end
  describe ssh_config do
    its('Protocol') { should eq('2') }
  end
end
        </code></pre>
      </div>
      <style>
        #ChefInspecOrConditions code {
          font-size: 1.3rem;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecControls">
      <div>
        <h2>Inspec Controls</h2>
        <pre><code>control 'Test *nix Super User' do
  impact 0.5
  title 'Superuser Test'
  desc 'Make sure the root user exists.'

  only_if do
    os.redhat? || os.debian? || os.linux? || os.darwin? || os.bsd?
  end

  describe user('root') do
    it { should exist }
  end
end
        </code></pre>
      </div>
      <style>
        #ChefInspecControls code {
          font-size: 0.8rem;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecImpacts">
      <div>
        <h2>Inspec "impact"</h2>
        <p>Values are based off <a href="https://www.first.org/cvss/calculator/3.0">CVSS 3.0</a></p>
        <ul>
          <li><strong>0.0 to &lt;0.01 (none)</strong> these are controls with no impact, they only provide information</li>
          <li><strong>0.01 to &lt;0.4 (low)</strong> these are controls with low impact</li>
          <li><strong>0.4 to &lt;0.7 (medium)</strong> these are controls with medium impact</li>
          <li><strong>0.7 to &lt;0.9 (high)</strong> these are controls with high impact</li>
          <li><strong>0.9 to 1.0 (critical)</strong> these are critical controls</li>
        </ul>
      </div>
    </section>

    <section class="slide" id="ChefInspecIncludeControls1">
      <div>
        <h2>Include controls</h2>
        <pre><code>control 'ssh-2'
control 'ssh-11'
control 'ssh-23'
...
include_controls 'nginx-hardening'
        </code></pre>
      </div>
    </section>

    <section class="slide" id="ChefInspecIncludeControls2">
      <div>
        <h2>Include controls</h2>
        <pre><code>include_controls 'nginx-hardening' do
  skip_control 'nginx-3'
  skip_control 'nginx-232'
end
include_controls 'nginx-hardening' do
  control 'nginx-2'
  control 'nginx-4'
end
        </code></pre>
      </div>
      <style>
        #ChefInspecIncludeControls2 code {
          font-size: 1.2rem;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecIncludeControls3">
      <div>
        <h2>Modify included controls</h2>
        <pre><code>include_controls 'nginx-hardening' do
  control 'nginx-2' do
    impact 0.5
  end
  control 'nginx-4' do
    impact 1.0
  end
end
        </code></pre>
      </div>
      <style>
        #ChefInspecIncludeControls3 code {
          font-size: 1.2rem;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecSupermarket">
      <div>
        <img src="pictures/inspec_supermarket.png" alt="" class="cover" />
      </div>
    </section>

    <section class="slide" id="ChefInspecDevSec">
      <div>
        <h2>DevSec: DevOps + Security</h2>
        <p><a href="https://dev-sec.io/">DevSec</a> - Automatic Server Hardening</p>
        <img src="pictures/devsec.png" alt="" class="place b" />
      </div>
      <style>
        #ChefInspecDevSec img {
          height: 65%;
        }
      </style>
    </section>

    <section class="slide" id="ChefInspecSupermarketApply">
      <div>
        <pre><code>$ inspec supermarket info dev-sec/linux-baseline
name: linux-baseline
owner: dev-sec
url: https://github.com/dev-sec/linux-baseline

description: Linux compliance profile, used for Security + DevOps. More information is available at http://dev-sec.io

$ inspec supermarket exec dev-sec/linux-baseline -t ssh://root:password@target

$ inspec exec https://github.com/dev-sec/linux-baseline -t ssh://root:password@target

$ inspec exec https://github.com/dev-sec/linux-baseline -t ssh://root:password@target
    --controls package-08</code></pre>
      </div>
      <style>
        #ChefInspecSupermarketApply code {
          font-size: 1rem;
        }
      </style>
    </section>

    <section class="slide" id="ComplianceDocumentationCover">
      <h2 class="shout">Compliance Documentation</h2>
    </section>

    <section class="slide" id="ComplianceDocumentationBodies">
      <div>
        <h2>Compliance standards bodies</h2>
        <ul>
          <li>International Organization for Standardization (ISO)</li>
          <li>Center for Internet Security (CIS)</li>
          <li>Department of Defense (DoD)</li>
          <li>EU General Data Protection Regulation (GDPR)</li>
          <li>The Payment Card Industry Security Standards Council (PCI SSC)</li>
          <li>ect...</li>
        </ul>
      </div>
    </section>

    <section class="slide" id="ComplianceDocumentationExample">
      <div>
        <h2>Example: CIS 5.5.4</h2>
        <div class="columns two">
          <div>
            <pre><code>control 'cis-ubuntu-lts-5.4.4' do
  impact 0.7
  title 'Ensure default user umask is 027 or more restrictive'
  desc 'The default umask determines the permissions'\
        'of files created by users.'
  describe file('/etc/bash.bashrc') do
    its('content') { should match /^umask 027/ }
  end
  describe file('/etc/profile') do
    its('content') { should match /^umask 027/ }
  end
end</code></pre>
            <p>Many teams use the <a href="https://en.wikipedia.org/wiki/Common_Vulnerability_Scoring_System">Common Vulnerability Scoring System</a> to assign the appropriate impact value to each test.</p>
          </div>
          <img src="pictures/cis_554.png" alt="cis_554" />
        </div>
      </div>
      <style>
        #ComplianceDocumentationExample code {
          font-size: 0.6rem;
        }
        #ComplianceDocumentationExample p {
          font-size: 0.8rem;
        }
        #ComplianceDocumentationExample img {
          width: 100%
        }
      </style>
    </section>

    <section class="slide" id="CloudPlatformsCover">
      <h2 class="shout">Cloud Platforms</h2>
    </section>

    <section class="slide" id="CloudPlatformsAwsExample">
      <div>
        <h2>AWS example</h2>
        <pre><code>describe aws_security_group("sg-12345678") do
  it { should exist }
end

$ inspec exec test.rb -t aws://profile
            </code></pre>
      </div>
      <style>
        #CloudPlatformsAwsExample code {
          font-size: 1.4rem;
        }
      </style>
    </section>

    <section class="slide" id="CloudPlatformsGcpExample">
      <div>
        <h2>GCP example</h2>
        <pre><code>describe google_compute_network(project: gcp_project_id, name: 'foo') do
 it { should exist }
 its('name') { should eq 'foo' }
 its('subnetworks.count') { should eq 1 }
 its('subnetworks.first') { should match 'bar' }
 its('routing_config.routing_mode') { should eq 'REGIONAL' }
 its('auto_create_subnetworks') { should be false }
end

$ inspec exec test.rb -t gcp://
                </code></pre>
      </div>
      <style>
        #CloudPlatformsGcpExample code {
          font-size: 1.2rem;
        }
      </style>
    </section>

    <section class="slide" id="CloudPlatformsTerraform1">
      <div>
        <h2>InSpec + Terraform</h2>
        <pre><code>resource "aws_security_group" "default" {
  name        = "terraform_example"
  description = "Used in the terraform"
  vpc_id      = "${aws_vpc.default.id}"

  ...
}

output "vpc_id" {
  value = "${aws_vpc.default.id}"
}

$ terraform output --json > inspec_tests/files/terraform.json </code></pre>
      </div>
      <style>
        #CloudPlatformsTerraform1 code {
          font-size: 0.8rem;
        }
      </style>
    </section>

    <section class="slide" id="CloudPlatformsTerraform2">
      <div>
        <pre><code># load data from Terraform output
content = inspec.profile.file("terraform.json")
params = JSON.parse(content)

# store vpc in variable
<mark>VPC_ID</mark> = params['vpc_id']['value']

# you can use the variable in various spaces

describe aws_vpc(<mark>vpc_id: VPC_ID</mark>) do
  its('cidr_block') { should cmp '10.0.0.0/16' }
end

describe aws_security_group(group_name: 'terraform_example') do
  it { should exist }
  its('group_name') { should eq 'terraform_example' }
  its('description') { should eq 'Used in the terraform' }
  its('vpc_id') { <mark>should eq VPC_ID</mark> }
end</code></pre>
      </div>
      <style>
        #CloudPlatformsTerraform2 code {
          font-size: 0.8rem;
        }
      </style>
    </section>

    <section class="slide" id="TroubleshootingCover">
      <h2 class="shout">Troubleshooting</h2>
    </section>

    <section class="slide" id="TroubleshootingShell">
      <div>
        <h2>Inspec Shell</h2>
        <div class="columns two">
          <pre><code>$ inspec shell
$ inspec shell -t ssh://root@192.168.64.2:11022

Welcome to the interactive InSpec Shell
To find out how to use it, type: help

You are currently running on:

Name: mac_os_x
Families: darwin, bsd, unix, os
Release: 19.4.0
Arch: x86_64

inspec> 2 + 2
=> 4
inspec> quit
          </code></pre>
          <video autoplay loop muted preload>
            <source src="pictures/debugging.mp4" type='video/mp4;codecs="avc1.42E01E, mp4a.40.2"' />
          </video>
        </div>
      </div>
      <style>
        #TroubleshootingShell code {
          font-size: 0.8rem;
        }
        #TroubleshootingShell video {
          width: 100%;
        }
      </style>
    </section>

    <section class="slide" id="ConclusionCover">
      <h2 class="shout">Conclusion</h2>
    </section>

    <section class="slide" id="ConclusionSlide">
      <div>
        <h2>Conclusion</h2>
        <ul>
          <li>Help you turn your compliance, security, and other policy requirements into automated tests</li>
          <li>Platform agnostic tool</li>
          <li>Ruby language!</li>
        </ul>
        <div class="imgContainer">
          <img src="pictures/teams.png" alt="team" class="place b" />
        </div>
      </div>
      <style>
        #ConclusionSlide .imgContainer {
          text-align: center;
          display: block;
        }
        #ConclusionSlide img {
          padding-bottom: 40px;
          width: 60%;
        }
      </style>
    </section>

    <section class="slide" id="QuestionsSlide"><div>
      <h2>&lt;Thank You!&gt; Questions?</h2>
      <div class="contacts">
        <h3>Contact information</h3>
        <ul>
          <li>web: <a href="http://leopard.in.ua/">leopard.in.ua</a></li>
          <li>github: <a href="https://github.com/le0pard">le0pard</a></li>
          <li>twitter: <a href="https://twitter.com/leopard_me">@leopard_me</a></li>
        </ul>
      </div>
      <img src="pictures/questions.png" alt="QuestionsSlide" class="place l b" />
      <style>
        #QuestionsSlide .contacts {
          margin-top: 100px;
          margin-left: 450px;
        }
      </style>
    </div></section>

    <div class="progress"></div>

    <script src="shower/shower.min.js"></script>
    <!-- Copyright © 2019 Yours Truly, Famous Inc. -->

</body>
</html>
